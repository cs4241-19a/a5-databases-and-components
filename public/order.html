<!doctype html>
<html lang="en">
  <head>
    <title>Restaurant</title>
    <meta charset="utf-8">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link href="/css/style.css" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Lobster+Two|Raleway&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link href="https://unpkg.com/material-components-web@latest/dist/material-components-web.min.css" rel="stylesheet">
  </head>
  
  <body id="body" class="mdc-typography mdc-layout-grid">
    <div class="mdc-layout-grid__inner">
      <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-7-desktop mdc-layout-grid__cell--span-12-tablet mdc-layout-grid__cell--span-12-phone">
        <nav class="mdc-tab-bar" role="tablist">
          <div class="mdc-tab-scroller">
            <div class="mdc-tab-scroller__scroll-area mdc-tab-scroller__scroll-area--scroll">
              <div class="mdc-tab-scroller__scroll-content">
                <button class="mdc-tab mdc-tab--active" role="tab" aria-selected="true" id="form-link" tabindex="0">
                    <span class="mdc-tab__content">
                      <span class="mdc-tab__text-label">Place an Order</span>
                    </span>
                  <span class="mdc-tab-indicator">
                      <span class="mdc-tab-indicator__content mdc-tab-indicator__content--underline"></span>
                    </span>
                  <span class="mdc-tab__ripple"></span>
                </button>
                <button class="mdc-tab" role="tab" aria-selected="false" id="table-link" tabindex="1">
                    <span class="mdc-tab__content">
                      <span class="mdc-tab__text-label">View Orders</span>
                    </span>
                  <span class="mdc-tab-indicator">
                      <span class="mdc-tab-indicator__content mdc-tab-indicator__content--underline"></span>
                    </span>
                  <span class="mdc-tab__ripple"></span>
                </button>
                <button class="mdc-tab" role="tab" aria-selected="false" id="logout-link" tabindex="1">
                    <span class="mdc-tab__content">
                      <span class="mdc-tab__text-label">Logout</span>
                    </span>
                  <span class="mdc-tab-indicator">
                      <span class="mdc-tab-indicator__content mdc-tab-indicator__content--underline"></span>
                    </span>
                  <span class="mdc-tab__ripple"></span>
                </button>
              </div>
            </div>
          </div>
        </nav>
      </div>
    </div>
    <header class="hero" style="display: flex; justify-content: center;">
      <img src="https://cdn.glitch.com/43008e21-b00d-4a43-831e-9d38ee279bc0%2Frice_bowl_header.jpg?v=1568002875243" id="rice-bowl" alt="4 bowls of different toppings">
      <h1>Bon Me</h1>
      <h2>Create your own rice bowl!</h2>
      <div class="bar"></div>
    </header>
    <main class="mdc-layout-grid__inner">
      <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-6-desktop mdc-layout-grid__cell--span-12">
        <div class="mdc-layout-grid__inner">
          <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-3-desktop"></div>
          <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-6-desktop mdc-layout-grid__cell--span-12-phone mdc-layout-grid__cell--span-12-tablet" style="text-align: center;">
            <div style="display: flex; flex-direction: column; align-items: center;">
                
              <!--    ORDER FORM    -->
                <div id="order-form">
                  <h3 class="mdc-typography--headline3">Create your own rice bowl!</h3>
                  
                  <form action="">
                    <div class="mdc-form-field" style="margin-bottom: 20px; width: 100%;">
                      <div class="mdc-text-field mdc-text-field--outlined" style="width: 100%;">
                        <input type="text" id="fstname" class="mdc-text-field__input" required>
                        <div class="mdc-notched-outline">
                          <div class="mdc-notched-outline__leading"></div>
                          <div class="mdc-notched-outline__notch">
                            <label for="fst-name" class="mdc-floating-label">Your First Name</label>
                          </div>
                          <div class="mdc-notched-outline__trailing"></div>
                        </div>
                      </div>
                    </div>
                    
                    <div class="mdc-form-field" style="margin-bottom: 20px; width: 100%;">
                      <div class="mdc-text-field mdc-text-field--outlined" style="width: 100%;">
                        <input type="text" id="lstname" class="mdc-text-field__input" required>
                        <div class="mdc-notched-outline">
                          <div class="mdc-notched-outline__leading"></div>
                          <div class="mdc-notched-outline__notch">
                            <label for="lst-name" class="mdc-floating-label">Your Last Name</label>
                          </div>
                          <div class="mdc-notched-outline__trailing"></div>
                        </div>
                      </div>
                    </div>
                    
                    <div class="mdc-form-field" style="margin-bottom: 20px; width: 100%;">
                      <div class="mdc-text-field mdc-text-field--outlined mdc-text-field--outlined" style="width: 100%;">
                        <input type="text" id="ordername" class="mdc-text-field__input" required>
                        <div class="mdc-notched-outline">
                          <div class="mdc-notched-outline__leading"></div>
                          <div class="mdc-notched-outline__notch">
                            <label for="ordername" class="mdc-floating-label">Provide us with your order name.</label>
                          </div>
                          <div class="mdc-notched-outline__trailing"></div>
                        </div>
                      </div>
                    </div>
                    <p> 
                      <b>REGULAR</b> Your choice of grain and protein with toasted sesame sauce, pickled carrots, daikon, mesclun, cilantro, scallions, & crispy shallots.
                    </p><br><br>
                    <div class="mdc-form-field" style="text-align: left;">
                      <label><b>Grain</b></label>
                      <div class="mdc-radio" role="radiogroup" aria-label="type-of-grain">
                        <input class="mdc-radio__native-control" type="radio" role="radio" checked id="brown_rice" name="grain" value="0">
                        <div class="mdc-radio__background">
                          <div class="mdc-radio__outer-circle"></div>
                          <div class="mdc-radio__inner-circle"></div>
                        </div>
                      </div>
                      <label for="brown_rice">Brown Rice</label><br>
                      <div class="mdc-radio">
                        <input class="mdc-radio__native-control" type="radio" role="radio" id="white_rice" name="grain" value="0">
                        <div class="mdc-radio__background">
                          <div class="mdc-radio__outer-circle"></div>
                          <div class="mdc-radio__inner-circle"></div>
                        </div>
                      </div>
                      <label for="white_rice">White Rice</label><br>
                      <div class="mdc-radio">
                        <input class="mdc-radio__native-control" type="radio" role="radio" id="quinoa_brown_rice" name="grain" value="1">
                        <div class="mdc-radio__background">
                          <div class="mdc-radio__outer-circle"></div>
                          <div class="mdc-radio__inner-circle"></div>
                        </div>
                      </div>
                      <label for="quinoa_brown_rice">Quinoa & Brown Rice</label><br>
                    </div>
                    
                    <div class="mdc-form-field">
                      <label ><b>Protein</b></label>
                      <div class="mdc-radio" role="radiogroup" aria-label="type-of-protein">
                        <input class="mdc-radio__native-control" type="radio" role="radio" checked id="salt_pepper_chk" name="protein" value="1">
                        <div class="mdc-radio__background">
                          <div class="mdc-radio__outer-circle"></div>
                          <div class="mdc-radio__inner-circle"></div>
                        </div>
                      </div>
                      <label for="salt_pepper_chk">Chinese Salt + Pepper Chicken</label>
                      <div class="mdc-radio">
                        <input class="mdc-radio__native-control" type="radio" role="radio" id="tamari_chk" name="protein" value="2">
                        <div class="mdc-radio__background">
                          <div class="mdc-radio__outer-circle"></div>
                          <div class="mdc-radio__inner-circle"></div>
                        </div>
                      </div>
                      <label for="tamari_chk">Tamari Chicken</label>
                      <div class="mdc-radio">
                        <input class="mdc-radio__native-control" type="radio" role="radio" id="char_siu_bbq_chk" name="protein" value="1">
                        <div class="mdc-radio__background">
                          <div class="mdc-radio__outer-circle"></div>
                          <div class="mdc-radio__inner-circle"></div>
                        </div>
                      </div>
                      <label for="char_siu_bbq_chk">Char Siu BBQ Chicken</label>
                      <div class="mdc-radio">
                        <input class="mdc-radio__native-control" type="radio" role="radio" id="gochujang_chk" name="protein" value="1">
                        <div class="mdc-radio__background">
                          <div class="mdc-radio__outer-circle"></div>
                          <div class="mdc-radio__inner-circle"></div>
                        </div>
                      </div>
                      <label for="gochujang_chk">Gochujang Chicken</label>
                      <div class="mdc-radio">
                        <input class="mdc-radio__native-control" type="radio" role="radio" id="miso_braised_pulled_pork" name="protein" value="1">
                        <div class="mdc-radio__background">
                          <div class="mdc-radio__outer-circle"></div>
                          <div class="mdc-radio__inner-circle"></div>
                        </div>
                      </div>
                      <label for="miso_braised_pulled_pork">Miso Braised Pulled Pork</label>
                      <div class="mdc-radio">
                        <input class="mdc-radio__native-control" type="radio" role="radio" id="fiery_chickpeas" name="protein" value="1">
                        <div class="mdc-radio__background">
                          <div class="mdc-radio__outer-circle"></div>
                          <div class="mdc-radio__inner-circle"></div>
                        </div>
                      </div>
                      <label for="fiery_chickpeas">Fiery Chickpeas</label>
                      <div class="mdc-radio">
                        <input class="mdc-radio__native-control" type="radio" role="radio" id="roasted_paprika_tofu" name="protein" value="1">
                        <div class="mdc-radio__background">
                          <div class="mdc-radio__outer-circle"></div>
                          <div class="mdc-radio__inner-circle"></div>
                        </div>
                      </div>
                      <label for="roasted_paprika_tofu">Roasted Paprika Tofu</label>              
                    </div>
                    <div id="submit-btn">
                      <button class="submit-btn mdc-button mdc-button--raised" style="margin-top: 20px;">Place Order</button>
                    </div>
                  </form>
                </div>
                <!--    ORDER CONFIRMATION    -->
                <div id="order-confirmation">
                  <h3 class="mdc-typography--headline3">success!</h3>
                  <img src="/images/success.png" id="success-pic" alt="cartoon dumpling with a happy facial expression" style="margin-bottom: 20px;">
                  <button id="new-order-btn" class="mdc-button mdc-button--raised">View Orders</button>
                </div>
                <!--    ORDER TABLE    -->
                <div id="order-table">
                  <h3 class="mdc-typography--headline3">Rice Bowl Orders</h3>
                  <div class="mdc-data-table">
                    <table id="orders" class="mdc-data-table__table" aria-label="rice bowl orders"></table>
                  </div>
                </div>
                <!--    UPDATE ORDER FORM    -->
                <div id="update-order-form">
                  <h3 class="mdc-typography--headline3">Update Your Order</h3>
                  <form action="">
                    <div class="mdc-form-field" style="margin-bottom: 20px; width: 100%;">
                      <div class="mdc-text-field mdc-text-field--outlined" style="width: 100%;">
                        <input type="text" id="updateFstName" class="mdc-text-field__input" required>
                        <div class="mdc-notched-outline">
                          <div class="mdc-notched-outline__leading"></div>
                          <div class="mdc-notched-outline__notch">
                            <label for="updateFstName" class="mdc-floating-label">Your First Name</label>
                          </div>
                          <div class="mdc-notched-outline__trailing"></div>
                        </div>
                      </div>
                    </div>
                    <div class="mdc-form-field" style="margin-bottom: 20px; width: 100%;">
                      <div class="mdc-text-field mdc-text-field--outlined" style="width: 100%;">
                        <input type="text" id="updateLstName" class="mdc-text-field__input" required>
                        <div class="mdc-notched-outline">
                          <div class="mdc-notched-outline__leading"></div>
                          <div class="mdc-notched-outline__notch">
                            <label for="updateLstName" class="mdc-floating-label">Your Last Name</label>
                          </div>
                          <div class="mdc-notched-outline__trailing"></div>
                        </div>
                      </div>
                    </div>
                    <div class="mdc-form-field" style="margin-bottom: 20px; width: 100%;">
                      <div class="mdc-text-field mdc-text-field--outlined mdc-text-field--outlined" style="width: 100%;">
                        <input type="text" id="updateOrderName" class="mdc-text-field__input" required>
                        <div class="mdc-notched-outline">
                          <div class="mdc-notched-outline__leading"></div>
                          <div class="mdc-notched-outline__notch">
                            <label for="updateOrderName" class="mdc-floating-label">Provide your order name</label>
                          </div>
                          <div class="mdc-notched-outline__trailing"></div>
                        </div>
                      </div>
                    </div>
                    <div class="mdc-form-field">
                      <label>Grain</label>
                      <div class="mdc-radio" role="radiogroup" aria-label="type-of-grain">
                        <input class="mdc-radio__native-control" type="radio" checked id="update_brown_rice3pork" name="updateGrain" value="0">
                        <div class="mdc-radio__background">
                          <div class="mdc-radio__outer-circle"></div>
                          <div class="mdc-radio__inner-circle"></div>
                        </div>
                      </div>
                      <label for="update_brown_rice">Brown Rice</label>

                      <div class="mdc-radio" role="radiogroup" aria-label="type-of-grain">
                        <input class="mdc-radio__native-control" type="radio" id="update_white_rice" name="updateGrain" value="0">
                        <div class="mdc-radio__background">
                          <div class="mdc-radio__outer-circle"></div>
                          <div class="mdc-radio__inner-circle"></div>
                        </div>
                      </div>
                      <label for="update_white_rice">White Rice</label>
                    
                      <div class="mdc-radio" role="radiogroup" aria-label="type-of-grain">
                        <input class="mdc-radio__native-control" type="radio" checked id="update_quinoa_brown_rice" name="updateGrain" value="1">
                        <div class="mdc-radio__background">
                          <div class="mdc-radio__outer-circle"></div>
                          <div class="mdc-radio__inner-circle"></div>
                        </div>
                      </div>
                      <label for="update_quinoa_brown_rice">Quinoa & Brown Rice</label>
                    </div>
                    
                    <div class="mdc-form-field">
                      <label>Protein</label>
                      <div class="mdc-radio" role="radiogroup" aria-label="type-of-protein">
                        <input class="mdc-radio__native-control" type="radio" role="radio" checked id="update_salt_pepper_chk" name="updateProtein" value="1">
                        <div class="mdc-radio__background">
                          <div class="mdc-radio__outer-circle"></div>
                          <div class="mdc-radio__inner-circle"></div>
                        </div>
                      </div>
                      <label for="update_salt_pepper_chk">Chinese Salt + Pepper Chicken</label>
                      <div class="mdc-radio" role="radiogroup" aria-label="type-of-protein">
                        <input class="mdc-radio__native-control" type="radio" role="radio" checked id="update_tamari_chk" name="updateProtein" value="2">
                        <div class="mdc-radio__background">
                          <div class="mdc-radio__outer-circle"></div>
                          <div class="mdc-radio__inner-circle"></div>
                        </div>
                      </div>
                      <label for="update_tamari_chk">Tamari Chicken</label>
                      <div class="mdc-radio" role="radiogroup" aria-label="type-of-protein">
                        <input class="mdc-radio__native-control" type="radio" role="radio" checked id="update_char_siu_bbq_chk" name="updateProtein" value="1">
                        <div class="mdc-radio__background">
                          <div class="mdc-radio__outer-circle"></div>
                          <div class="mdc-radio__inner-circle"></div>
                        </div>
                      </div>
                      <label for="update_char_siu_bbq_chk">Char Siu BBQ Chicken</label>
                      <div class="mdc-radio" role="radiogroup" aria-label="type-of-protein">
                        <input class="mdc-radio__native-control" type="radio" role="radio" checked id="update_gochujang_chk" name="updateProtein" value="1">
                        <div class="mdc-radio__background">
                          <div class="mdc-radio__outer-circle"></div>
                          <div class="mdc-radio__inner-circle"></div>
                        </div>
                      </div>
                      <label for="update_gochujang_chk">Gochujang Chicken</label>
                      <div class="mdc-radio" role="radiogroup" aria-label="type-of-protein">
                        <input class="mdc-radio__native-control" type="radio" role="radio" checked id="update_miso_braised_pulled_pork" name="updateProtein" value="1">
                        <div class="mdc-radio__background">
                          <div class="mdc-radio__outer-circle"></div>
                          <div class="mdc-radio__inner-circle"></div>
                        </div>
                      </div>
                      <label for="update_miso_braised_pulled_pork">Miso Braised Pulled Pork</label>
                      <div class="mdc-radio" role="radiogroup" aria-label="type-of-protein">
                        <input class="mdc-radio__native-control" type="radio" role="radio" checked id="update_fiery_chickpeas" name="updateProtein" value="1">
                        <div class="mdc-radio__background">
                          <div class="mdc-radio__outer-circle"></div>
                          <div class="mdc-radio__inner-circle"></div>
                        </div>
                      </div>
                      <label for="update_fiery_chickpeas">Fiery Chickpeas</label>
                      <div class="mdc-radio" role="radiogroup" aria-label="type-of-protein">
                        <input class="mdc-radio__native-control" type="radio" role="radio" checked id="update_roasted_paprika_tofu" name="updateProtein" value="1">
                        <div class="mdc-radio__background">
                          <div class="mdc-radio__outer-circle"></div>
                          <div class="mdc-radio__inner-circle"></div>
                        </div>
                      </div>
                      <label for="update_roasted_paprika_tofu">Roasted Paprika Tofu</label>
                    
                    </div>

                    <div id="update-form-btns" style="margin-top: 20px;">
                      <button id="cancel-btn" class="mdc-button mdc-button--outlined">Cancel</button>
                      <button id="update-btn" class="mdc-button mdc-button--raised">Update Order</button>
                    </div>
                  </form>
                </div>
              <!--        ERRORS        -->
              <div class="mdc-card" id="form-error">
                Please complete the form.
              </div>
              <div class="mdc-card" id="username-error">
                Please enter a correct username or password.
              </div>
              <div class="mdc-card" id="login-error">
                Please login to place an order.
                <div class="mdc-card__actions" style="display: flex; justify-content: center; margin-top: 10px;">
                  <button class="mdc-button mdc-card__action mdc-card__action--button mdc-button--outlined"  id="return-to-login-btn">
                    <span class="mdc-button__label">Login</span>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>
  </body>

  <script src="https://unpkg.com/material-components-web@latest/dist/material-components-web.min.js"></script>
  <script>
    const button = document.querySelector('.submit-btn');
    mdc.ripple.MDCRipple.attachTo(button);
    mdc.autoInit();
    const textFields = document.querySelectorAll('.mdc-text-field');
    for (const textField of textFields) {
      mdc.textField.MDCTextField.attachTo(textField);
    }
    const tabBar = document.querySelector('.mdc-tab-bar');
    mdc.tabBar.MDCTabBar.attachTo(tabBar);
    const addOrder = function( e ) {
      e.preventDefault();
      const newOrder = {
        fstname: document.getElementById( 'fst-name' ).value,
        lstname: document.getElementById( 'lst-name' ).value,
        ordername: document.getElementById( 'ordername' ).value,
        typeOfGrain: document.querySelector('input[name="grain"]:checked').value,
        typeOfProtein: document.querySelector('input[name="protein"]:checked').value
      };
      if (orderValidation(newOrder.fstname, newOrder.lstname, newOrder.ordername)) {
        const body = JSON.stringify( newOrder );
        fetch( '/submit', {
          method:'POST',
          headers: { 'Content-Type': 'application/json' },
          body
        }).then(function (response) {
          if (response.status === 200) {
            document.getElementById('order-confirmation').style.display = "flex";
            document.getElementById('order-form').style.display = "none";
            resetOrderForm();
          } else {
            document.getElementById('login-error').style.display = "block";
          }
        });
      }
      return false;
    };
    const deleteOrder = function (index) {
      const orderNumber = { orderNumber: index };
      const body = JSON.stringify(orderNumber);
      fetch('/delete', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body
      });
      fetchOrders();
    };
    const fetchOrders = async function() {
      try {
        const resp = await fetch('/orders', { method: 'GET' });
        const data = await resp.json();
        const orders = data.data;
        let htmlDiv = document.getElementById('orders');
        htmlDiv.innerHTML = '<tr class="mdc-data-table__header-row">\n' +
                '              <th class="mdc-data-table__header-cell" role="columnheader" scope="col">First Name</th>\n' +
                '              <th class="mdc-data-table__header-cell" role="columnheader" scope="col">Last Name</th>\n' +
                '              <th class="mdc-data-table__header-cell" role="columnheader" scope="col">Order Name</th>\n' +
                '              <th class="mdc-data-table__header-cell" role="columnheader" scope="col">Grain</th>\n' +
                '              <th class="mdc-data-table__header-cell" role="columnheader" scope="col">Protein</th>\n' +
                '              <th class="mdc-data-table__header-cell" role="columnheader" scope="col">Price</th>\n' +
                '              <th class="mdc-data-table__header-cell" role="columnheader" scope="col"></th>\n' +
                '              <th class="mdc-data-table__header-cell" role="columnheader" scope="col"></th>\n' +
                '            </tr>' +
                '            <tbody class="mdc-data-table__content">';
        for (let i = 0; i < orders.length; i++) {
          const order = orders[i];
          const stringOrder = JSON.stringify(orders[i]);
          const garlic = (order.garlic ? 'Yes' : 'No');
          let newRow = '<tr class="mdc-data-table__row">\n';
          newRow += (`<td class="mdc-data-table__cell"> ${order.fstname} </td>\n`);
          newRow += (`<td class="mdc-data-table__cell"> ${order.lstname} </td>\n`);
          newRow += (`<td class="mdc-data-table__cell"> ${order.ordername} </td>\n`);
          newRow += (`<td class="mdc-data-table__cell"> ${order.typeOfGrain} pieces</td>\n`);
          newRow += (`<td class="mdc-data-table__cell"> ${order.typeOfProtein} pieces</td>\n`);
          newRow += (`<td class="mdc-data-table__cell mdc-data-table__cell--numeric"> ${order.price} </td>\n`);
          newRow += (`<td class="mdc-data-table__cell"> <button id="update-button-${i}" class="mdc-button mdc-button--dense mdc-button--outlined" onclick="viewUpdateForm(${i})" data-string=`
                  + encodeURIComponent(stringOrder) +
                  `>Edit</button> </td>\n`);
          newRow += (`<td class="mdc-data-table__cell"> <button id="delete-button-${i}" class="mdc-button mdc-button--dense mdc-button--raised" onclick="deleteOrder(${i})" data-mdc-auto-init=”MDCRipple”>Delete</button> </td>\n`);
          newRow += '</tr>';
          htmlDiv.innerHTML += newRow;
        }
        htmlDiv.innerHTML += '</tbody>';
      } catch (err) {
        document.getElementById('login-error').style.display = "block";
      }
      return false;
    };
    const updateOrder = ( e ) => {
      e.preventDefault();
      const updatedOrder = {
        index: document.getElementById('update-btn').dataset.index,
        fstname: document.getElementById('updateFstName').value,
        lstname: document.getElementById('updateLstName').value,
        ordername: document.getElementById('updateOrderName').value,
        typeOfGrain: document.querySelector('input[name="updateGrain"]:checked').value,
        typeOfProtein: document.querySelector('input[name="updateProtein"]:checked').value
      };
      if (orderValidation(updatedOrder.fstname, updatedOrder.lstname, updatedOrder.ordername)) {
        const body = JSON.stringify(updatedOrder);
        fetch('/update', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body
        }).then(function () {
          viewOrderTable();
        });
      }
      return false;
    };
    const resetOrderForm = () => {
      document.getElementById( 'fstname' ).value = '';
      document.getElementById( 'lstname' ).value = '';
      document.getElementById( 'ordername' ).value = '';
      document.getElementById('brown_rice').checked = true;
      document.getElementById('salt_pepper_chk').checked = true;
    };
    const orderValidation = function (fstname, lstname, ordername) {
      if (fstname || lstname === '') {
        document.getElementById('form-error').style.display = "block";
        document.getElementById('form-error').focus();
        return false;
      } else if (ordername === '') {
        document.getElementById('form-error').style.display = "block";
        document.getElementById('form-error').focus();
        return false;
      } else {
        document.getElementById('form-error').style.display = "none";
        return true;
      }
    };
    const logout = function() {
      fetch( '/logout', {
        method:'GET'
      }).then(function () {
        viewLoginForm();
      });
      return false;
    };
    const viewLoginForm = function() {
      resetOrderForm();
      window.location="/login.html";
    };
    const viewOrderForm = function() {
      document.getElementById('form-error').style.display = "none";
      document.getElementById('order-table').style.display = "none";
      document.getElementById('update-order-form').style.display = "none";
      document.getElementById('order-confirmation').style.display = "none";
      document.getElementById('order-form').style.display = "block";
      document.getElementById('login-error').style.display = "none";
      document.getElementById('username-error').style.display = "none";
      resetOrderForm();
    };
    const viewOrderTable  = function () {
      document.getElementById('order-table').style.display = "flex";
      document.getElementById('order-form').style.display = "none";
      document.getElementById('update-order-form').style.display = "none";
      document.getElementById('order-confirmation').style.display = "none";
      document.getElementById('form-error').style.display = "none";
      document.getElementById('login-error').style.display = "none";
      document.getElementById('username-error').style.display = "none";
      fetchOrders();
      return false;
    };
    const viewUpdateForm = function (index) {
      let orderToUpdate = decodeURIComponent(document.getElementById(`update-button-${index}`).dataset.string);
      orderToUpdate = JSON.parse(orderToUpdate);
      document.getElementById('order-table').style.display = "none";
      document.getElementById('update-order-form').style.display="block";
      // load values
      document.getElementById('update-btn').dataset.index = index;
      document.getElementById('updateFstName').value=orderToUpdate.fstname;
      document.getElementById('updateLstName').value=orderToUpdate.lstname;
      document.getElementById('updateOrderName').value=orderToUpdate.ordername;
      orderToUpdate.typeOfGrain === 3 ? document.getElementById('update_brown_rice').checked = true : document.getElementById('update_white_rice').checked = true;
      orderToUpdate.typeOfProtein ? document.getElementById('update_salt_pepper_chk').checked = true : document.getElementById('update_fiery_chickpeas').checked = true;
      return false;
    };
    window.onload = function() {
      const submitButton = document.getElementById( 'submit-btn' );
      submitButton.onclick = addOrder;
      const tableLink = document.getElementById( 'table-link' );
      tableLink.onclick = viewOrderTable;
      const formLink = document.getElementById( 'form-link' );
      formLink.onclick = viewOrderForm;
      const cancelButton = document.getElementById( 'cancel-btn' );
      cancelButton.onclick = viewOrderTable;
      const updateButton = document.getElementById( 'update-btn' );
      updateButton.onclick = updateOrder;
      const newOrderButton = document.getElementById( 'new-order-btn' );
      newOrderButton.onclick = viewOrderForm;
      const loginButton = document.getElementById('return-to-login-btn');
      loginButton.onclick = viewLoginForm;
      const logoutButton = document.getElementById('logout-link');
      logoutButton.onclick = logout;
    };
  </script>
</html>